# ğŸ¦¾ Aria: J.A.R.V.I.S. Protocol

<div align="center">

[![System Status](https://img.shields.io/badge/System-ONLINE-success?style=flat-square)](https://github.com/Zephyr-Wach/AIGF-Aria)
[![Architecture](https://img.shields.io/badge/Architecture-Hybrid_(Local_%2B_Cloud)-blueviolet?style=flat-square)](https://github.com/ml-explore/mlx)
[![Class](https://img.shields.io/badge/Class-Cognitive_Daemon-orange?style=flat-square)](LICENSE)

**Just A Rather Intelligent Agent (åªæ˜¯ä¸€ä¸ªç›¸å½“æ™ºèƒ½çš„ä»£ç†)**
*ä½ çš„é€šç”¨å‹è®¤çŸ¥æ“ä½œç³»ç»Ÿã€‚*

[English](README.md) | [ç®€ä½“ä¸­æ–‡](README_CN.md)

</div>

---

## ğŸ“¡ é¡¹ç›®ç°çŠ¶ (Project Status) 

**Aria ç›®å‰ä¸»è¦ä½œä¸ºä¸€ä¸ªâ€œäººæ ¼ä¿®æ­£è¡¥ä¸â€ (LoRA) å­˜åœ¨ã€‚** å¥¹æ˜¯ä¸€ä¸ªç»è¿‡æ·±åº¦å¾®è°ƒçš„æ¨¡å‹æƒé‡ï¼Œæ—¨åœ¨å°† Qwençš„é€šç”¨èƒ½åŠ›è½¬åŒ–ä¸ºä¸€ä¸ªå…·æœ‰**æ‰¹åˆ¤æ€§æ€ç»´ã€æå®¢å®¡ç¾ä¸é€»è¾‘å…±é¸£**çš„â€œæ™ºæ€§ä¼´ä¾£â€ã€‚ æœ¬é¡¹ç›® (`AIGF-Aria`) çš„é•¿æœŸç›®æ ‡æ˜¯å›´ç»•è¿™ä¸ªäººæ ¼æ ¸å¿ƒï¼Œæ„å»ºä¸€å¥—ç±»ä¼¼ J.A.R.V.I.S. çš„æœ¬åœ°ä»£ç†æ¡†æ¶ã€‚**ç›®å‰ï¼ŒLoRA æƒé‡å·²ç¨³å®šå¯ç”¨ï¼ˆSoulï¼‰ï¼Œè€Œä»£ç†å·¥å…·é“¾ï¼ˆBodyï¼‰æ­£åœ¨ç§¯æå¼€å‘ä¸­ã€‚**

> "çµé­‚å·²å°±ä½ï¼Œæ­£åœ¨æ„å»ºèº¯å£³ã€‚"

---

## ğŸ—ºï¸ å¼€å‘è·¯çº¿å›¾ (Development Roadmap)

### Phase 1: çµé­‚æ³¨å…¥ (The Foundation)
*ç¡®ç«‹äººæ ¼åŸºè°ƒã€‚*

- [x] **Milestone 1.1: ç¯å¢ƒä¸åŸºç¡€å›è·¯**
    - [x] Task: é…ç½®ç¯å¢ƒä¸ä¾èµ–ã€‚
    - [x] Task: å®ç°åŸºäºæœ¬åœ°æ¨¡å‹çš„åŸºç¡€å¾ªç¯ã€‚
    - [x] Task: å®šä¹‰åŸºç¡€ System Prompt ç»“æ„ã€‚

### Phase 2: æ„Ÿå®˜å»¶ä¼¸ (The Tools)
*å°† Aria è¿æ¥è‡³æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸å·¥ä½œæµã€é•¿æœŸè®°å¿†ã€‚*

- [x] **Milestone 2.1: æŒ‡ä»¤è·¯ç”±å™¨**
    - [x] Task: é‡æ„ä¸»å¾ªç¯ä»¥æ”¯æŒ `/command` æŒ‡ä»¤è§£æã€‚
    - [x] Task: åˆ›å»ºæŠ½è±¡ `Tool` æ¥å£ç±»ã€‚
- [ ] **Milestone 2.2: è®°å¿†æŒä¹…åŒ–**
    - [ ] Task: å®ç° `save_history()` å’Œ `load_history()` (JSON/DB)ã€‚
    - [ ] Task: å®ç°ä¸Šä¸‹æ–‡çª—å£ç®¡ç† (ä¿ç•™æœ€è¿‘ N è½®)ã€‚
    - [ ] **Challenge:** å®ç°ç³»ç»Ÿé‡å¯åçš„æ„è¯†è¿ç»­æ€§ã€‚

### Phase 3: èµ›åšå…±ç”Ÿ (Autonomy)
*èµ‹äºˆ Aria ä¸»åŠ¨æ€§ä¸è§†è§‰èƒ½åŠ›ã€‚*

- [ ] **Milestone 3.1: ä¸»åŠ¨è§¦å‘å™¨**
    - [ ] Task: å®ç°ç©ºé—²æ£€æµ‹ (æ— æ“ä½œ 30 åˆ†é’Ÿåè§¦å‘)ã€‚
    - [ ] Task: å®ç°åŸºäºæ—¶é—´çš„é—®å€™ (æ—©å®‰/æ™šå®‰)ã€‚
- [ ] **Milestone 3.2: è§†è§‰çš®å±‚**
    - [ ] Task: é›†æˆè§†è§‰æ¨¡å‹ (å¦‚ Qwen-VL)ã€‚
    - [ ] Task: åˆ›å»º `/look` æŒ‡ä»¤ä»¥åˆ†æå±å¹•å†…å®¹ã€‚

---

## ğŸ“ˆ ç‰ˆæœ¬è¿­ä»£è®°å½• (Changelog)

| ç‰ˆæœ¬     | æ ¸å¿ƒå›°å¢ƒ                           | è§£å†³æ–¹æ¡ˆä¸æ”¹è¿›                                               | çŠ¶æ€         |
| :------- | :--------------------------------- | :----------------------------------------------------------- | :----------- |
| **v1.0** | å¤è¯»æœºæ•ˆåº”ï¼Œå¯¹è¯æ— é€»è¾‘             | å»ºç«‹ JSONL ç»“æ„åŒ–æ•°æ®å¤„ç†æµç¨‹                                | âŒ åºŸå¼ƒ       |
| **v2.0** | å‰§æƒ…ç‚¸å¼¹: é¢‘ç¹æåˆ°æ’è½¦/è€ƒè¯•ç­‰çäº‹  | å¼•å…¥ `device_map` é€‚é…ï¼Œå°è¯•åˆæ­¥æ¸…æ´—                         | âš ï¸ åœç”¨       |
| **v3.1** | è¿‡åº¦æ´—è„‘: 5 Epoch å¯¼è‡´æ¨¡å‹ä¸§å¤±é€»è¾‘ | é™ä½è®­ç»ƒå¼ºåº¦ï¼Œåæ€ Rank æƒé‡                                 | âš ï¸ åœç”¨       |
| **v3.2** | ç¥å¿—æ¸…é†’: è¯­æ„Ÿä¸é€»è¾‘çš„å¹³è¡¡ç‚¹       | **ç‰©ç†é»‘åå•è¿‡æ»¤ + æä½ Rank (8)**                           | âœ… **Stable** |
| **v4.1** | v3.2åŸºç¡€ä¸Šä»3Bæå‡åˆ°7/8B           | é‡åŒ– 7B æ¨¡å‹ä¾¿äº MacBook Air ä½¿ç”¨                            | âœ… **Stable** |
| **v4.2** | ariaç†è§£ç”¨æˆ·è¾“å…¥è¯­å¥æ‰§è¡ŒæŒ‡ä»¤       | **è¯­ä¹‰è·¯ç”± (Semantic Router)** + **JIT åŠ¨æ€æ³¨å…¥** + **ReAct å›æ—‹é•–æ¶æ„** | âœ… **Stable** |

---

## ğŸ“¥ æ¨¡å‹æƒé‡ä¸‹è½½ (Model Weights)

Aria çš„ LoRA æƒé‡å·²æ‰˜ç®¡è‡³ Hugging Faceã€‚è¯¥æƒé‡åŸºäº Qwen2.5-3B-Instruct è®­ç»ƒï¼Œä¸“é—¨ä¼˜åŒ–äº†æ—¥å¸¸å¯¹è¯çš„è¯­æ„Ÿä¸æƒ…æ„Ÿè¡¨è¾¾ã€‚

| æ¨¡å‹ç‰ˆæœ¬               | åº•åº§æ¨¡å‹                                                     | LoRA                                                         |
| :--------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| **Aria-v3.2 (ç¨³å®šç‰ˆ)** | [Qwen2.5-3B-Instruct](https://huggingface.co/Qwen/Qwen2.5-3B-Instruct) | [zephyr-zw666/AIGF-Aria-v3.2-LoRA](https://huggingface.co/zephyr-zw666/AIGF-Aria-v3.2-LoRA) |
| **Aria-v4.0 (ç¨³å®šç‰ˆ)** | [zephyr-zw666/Qwen2.5-7B-4bit](https://huggingface.co/zephyr-zw666/Qwen2.5-7B-4bit) | [zephyr-zw666/AIGF-Aria-v4.0-LoRA](https://huggingface.co/zephyr-zw666/AIGF-Aria-v4.0-LoRA) |

---

## ğŸ› ï¸ å¤åˆ»æŒ‡å— (Replication Protocol)

å¦‚æœä½ æƒ³è®­ç»ƒå±äºè‡ªå·±çš„ Ariaï¼Œå¯ä»¥å‚è€ƒæœ¬ä»“åº“çš„æ–‡ä»¶ç»“æ„ä¸æµç¨‹ã€‚

### 1. ç›®å½•ç»“æ„ (Directory Structure)

```text
TrainAIGF/
â”œâ”€â”€ README.md                  # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ environment.yml            # Conda ç¯å¢ƒé…ç½®æ–‡ä»¶
â”œâ”€â”€ AIGF-Aria-LoRA/            # å­˜æ”¾è®­ç»ƒå¥½çš„ LoRA æƒé‡
â”‚   â”œâ”€â”€ AIGF-Aria-v3.2-LoRA
â”‚   â””â”€â”€ AIGF-Aria-v4.0-LoRA
â”œâ”€â”€ DataSet/                   # åŸå§‹æ•°æ®é›†ä¸æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ WeChatMsg_example.txt  # [ç¤ºä¾‹] èŠå¤©è®°å½•æ ¼å¼
â”‚   â””â”€â”€ build_dataset_V3.2.py  # æ•°æ®æ¸…æ´—è„šæœ¬
â”œâ”€â”€ chat_lora/                 # æ¨ç†/å¯¹è¯è„šæœ¬
â”‚   â”œâ”€â”€ chat_v3.2.1.py
â”‚   â””â”€â”€ chat_v4.1.0.py
â”œâ”€â”€ data/                      # è®­ç»ƒç”¨çš„æ ¼å¼åŒ–æ•°æ® (.jsonl)
â”‚   â””â”€â”€ train_v3.2_example.jsonl
â”œâ”€â”€ models/                    # åŸºåº§æ¨¡å‹ (Base Models)
â”‚   â”œâ”€â”€ Qwen2.5-3B-Instruct
â”‚   â””â”€â”€ Qwen2.5-7B-4bit
â””â”€â”€ train_lora/                # è®­ç»ƒ/å¾®è°ƒè„šæœ¬
    â”œâ”€â”€ train_v3.2.py
    â”œâ”€â”€ train_v4.0_14b.py
    â””â”€â”€ train_v4.0_7b.py
```

### 2. è¯¦ç»†æ­¥éª¤ (Step-by-Step)

1. **å‡†å¤‡æ•°æ®:**

   - ä¸‹è½½ä½ å’Œç›®æ ‡çš„èŠå¤©è®°å½•ã€‚è¯·å‚è€ƒ `DataSet/WeChatMsg_example.txt` çš„æ ¼å¼è¿›è¡Œæ•´ç†ã€‚

2. **æ•°æ®æ¸…æ´—ä¸å¤„ç†:**

   - è¿è¡Œ `DataSet/build_dataset_V3.2.py`ã€‚
   - **âš ï¸ å…³é”®è­¦å‘Š:** ä»£ç å†…è®¾ç½®äº†é»‘åå•æœºåˆ¶ã€‚è¯·åŠ¡å¿…ä¿®æ”¹å¹¶å±è”½é«˜é¢‘çš„ç‰¹æ®Šè¯æ±‡æˆ–ä¸ªäººéšç§ã€‚å¦åˆ™ LoRA ä¼šâ€œè¿‡æ‹Ÿåˆâ€è¿™äº›è¯æ±‡ï¼Œå¯¼è‡´ Aria åç»­åªä¼šèƒŒè¯µèŠå¤©è®°å½•ï¼Œå¤±å»æ³›åŒ–èƒ½åŠ›ã€‚

3. **å‡†å¤‡åŸºåº§æ¨¡å‹ (Base Model):**

   - **3B æ¨¡å‹:** å¦‚æœä½ çš„ç¯å¢ƒä¸æˆ‘ç›¸åŒ (MacBook Air)ï¼Œæ¨èä¸‹è½½ `Qwen2.5-3B-Instruct` è¿›è¡Œè®­ç»ƒã€‚

   - **7B/8B æ¨¡å‹è­¦å‘Š:**

     > MacBook Air (16GB) æ— æ³•æœ¬åœ°è®­ç»ƒ 7B/8B æ¨¡å‹ï¼Œä¼šå‘ç”Ÿæ˜¾å­˜æº¢å‡º (OOM)ã€‚ æˆ‘æ˜¯åœ¨äº‘ç®—åŠ›å¹³å°è®­ç»ƒåï¼Œå°†æƒé‡æ‹‰å–åˆ°æœ¬åœ°çš„ã€‚ æœ¬åœ°è¿è¡Œ 7B/8B åº•åº§å¿…é¡»å…ˆè¿›è¡Œ **4-bit é‡åŒ–**ã€‚

   - **14B æ¨¡å‹è­¦å‘Š:** ä¸å»ºè®®å°è¯•ã€‚Qwen2.5-14B çš„ Thinking Process ä¼šå¯¼è‡´æ¨¡å‹é™·å…¥æ— é™æ€è€ƒå¾ªç¯ï¼Œä¸é€‚åˆæ—¥å¸¸èŠå¤©äº¤äº’ã€‚

4. **é…ç½®è®­ç»ƒç¯å¢ƒ:**

   - ä¿®æ”¹ `train_lora` ç›®å½•ä¸‹çš„è„šæœ¬æ–‡ä»¶è·¯å¾„ï¼Œç¡®ä¿æŒ‡å‘ä½ æœ¬åœ°çš„çœŸå®è·¯å¾„ã€‚

5. **å¯åŠ¨ä¸è£…è½½:**

   - ä½¿ç”¨è®­ç»ƒå®Œæˆçš„ LoRA æƒé‡é…åˆåº•åº§æ¨¡å‹è¿è¡Œ `chat_lora` è„šæœ¬å³å¯å”¤é†’ Ariaã€‚